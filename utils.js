
// Función que compila los shaders que se le pasan por parámetro (vertex & fragment shaders)
// Recibe lso strings de cada shader y retorna un programa
function InitShaderProgram(vsSource, fsSource, gl) {
  // Función que compila cada shader individualmente
  const vs = CompileShader(gl.VERTEX_SHADER, vsSource, gl);
  const fs = CompileShader(gl.FRAGMENT_SHADER, fsSource, gl);

  // Crea y linkea el programa
  const prog = gl.createProgram();
  gl.attachShader(prog, vs);
  gl.attachShader(prog, fs);
  gl.linkProgram(prog);

  if (!gl.getProgramParameter(prog, gl.LINK_STATUS)) {
    alert("No se pudo inicializar el programa: " + gl.getProgramInfoLog(prog));
    return null;
  }
  return prog;
}

// Función para compilar shaders, recibe el tipo (gl.VERTEX_SHADER o gl.FRAGMENT_SHADER)
// y el código en forma de string. Es llamada por InitShaderProgram()
function CompileShader(type, source, gl) {
  // Creamos el shader
  const shader = gl.createShader(type);

  // Lo compilamos
  gl.shaderSource(shader, source);
  gl.compileShader(shader);

  // 	Verificamos si la compilación fue exitosa
  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
    alert(
      "Ocurrió un error durante la compilación del shader:\n" +
        gl.getShaderInfoLog(shader)
    );
    gl.deleteShader(shader);
    return null;
  }
  return shader;
}


export { InitShaderProgram };
